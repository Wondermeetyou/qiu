<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qiu.mapper.UserMapper">
    <update id="logout">
        update user set token = null where id=#{id}
    </update>
    <select id="pageC" resultType="com.qiu.entity.User">
        select * from user
    </select>
    <select id="pageCC" resultType="com.qiu.entity.User">
        select * from user${ew.customSqlSegment}
    </select>
    <select id="getByUsernameAndPassword" resultType="com.qiu.entity.User">
        select * from user where username=#{username} and password =#{password}
    </select>
    <select id="searchbykeyword" resultType="com.qiu.entity.User">
        select * from user where nickname like concat('%', #{nickname}, '%')
    </select>
    <select id="getmenu" resultType="com.qiu.entity.Menu">
        SELECT * from menu JOIN user
        WHERE
            menu.role_id >= user.role_id and user.id = #{id} and user.isValid = "y"
    </select>
    <select id="getparentmenu" resultType="com.qiu.entity.Menu">
        SELECT cate_name from menu
        WHERE
            parent_cate = 0
    </select>
    <select id="getchildmenu" resultType="com.qiu.entity.Menu">
        SELECT cate_name from menu
        WHERE
            parent_cate = #{cate_id}
    </select>
    <update id="UpdateToken" >
        UPDATE user set token =#{token} where username=#{loginUser.username} and password =#{loginUser.password}
    </update>
</mapper>

